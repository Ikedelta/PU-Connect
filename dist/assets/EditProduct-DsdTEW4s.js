import{j as e}from"./query-vendor-Cpskl8RO.js";import{u as w,h as k,r as o}from"./react-vendor-Bsfkyusf.js";import{u as S,s as b,I as C}from"./index-DVwrR-_V.js";import"./i18n-vendor-CQdsz7qV.js";import"./supabase-vendor-C3liu3n-.js";const T=["Electronics","Books & Stationery","Fashion & Accessories","Food & Beverages","Sports & Fitness","Home & Living","Services","Other"];function q(){const n=w(),{id:l}=k(),{user:c,profile:i}=S(),[h,x]=o.useState(!0),[m,u]=o.useState(!1),[g,d]=o.useState(null),[s,r]=o.useState({name:"",description:"",category:"",price:"",priceType:"fixed",images:[],whatsapp_number:""});o.useEffect(()=>{if(!c||i?.role!=="seller"&&i?.role!=="admin"&&i?.role!=="super_admin"){n("/marketplace");return}l&&f()},[l,c,i,n]);const f=async()=>{if(l){x(!0);try{const{data:t,error:a}=await b.from("products").select("*").eq("id",l).single();if(a)throw a;if(t){if(t.seller_id!==c?.id&&i?.role!=="admin"&&i?.role!=="super_admin"){n("/seller/dashboard");return}r({name:t.name||"",description:t.description||"",category:t.category||"",price:t.price?.toString()||"",priceType:t.price_type||"fixed",images:t.images||[],whatsapp_number:t.whatsapp_number||""})}}catch(t){console.error("Error fetching product:",t),d("Failed to load product")}finally{x(!1)}}},y=async t=>{t.preventDefault(),u(!0),d(null);try{const a={name:s.name,description:s.description,category:s.category,price:s.priceType==="fixed"?parseFloat(s.price):null,price_type:s.priceType,images:s.images.length>0?s.images:null,whatsapp_number:s.whatsapp_number||null,updated_at:new Date().toISOString()},{error:p}=await b.from("products").update(a).eq("id",l);if(p)throw p;n("/seller/dashboard")}catch(a){d(a.message||"Failed to update product")}finally{u(!1)}},j=t=>{r(a=>({...a,images:[...a.images,t]}))},N=t=>{r(a=>({...a,images:a.images.filter((p,v)=>v!==t)}))};return h?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 via-white to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})}):e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10 md:py-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-8 mb-16",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-gray-900 text-white text-[10px] font-bold uppercase tracking-widest rounded-full mb-6",children:[e.jsx("i",{className:"ri-edit-circle-line text-blue-400"}),"Manage Listing"]}),e.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 tracking-tight leading-tight mb-4",children:["Update",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600",children:"Product."})]}),e.jsx("p",{className:"text-gray-500 font-bold uppercase tracking-widest text-[10px] md:text-xs",children:"Review and refine your marketplace listing"})]}),e.jsxs("button",{onClick:()=>n("/seller/dashboard"),className:"text-[10px] font-bold text-gray-400 hover:text-blue-600 uppercase tracking-widest transition-colors cursor-pointer flex items-center justify-center gap-2 group",children:[e.jsx("i",{className:"ri-arrow-left-s-line text-lg group-hover:-translate-x-1 transition-transform"}),"Exit Editor"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-12",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl shadow-gray-200/40 border border-gray-100 p-8 md:p-12",children:[g&&e.jsxs("div",{className:"mb-10 p-6 bg-rose-50 border border-rose-100 rounded-2xl flex items-center gap-4 animate-in fade-in slide-in-from-top-4 duration-500",children:[e.jsx("i",{className:"ri-error-warning-fill text-2xl text-rose-600"}),e.jsx("p",{className:"text-sm font-bold text-rose-900 uppercase tracking-tight",children:g})]}),e.jsxs("form",{onSubmit:y,className:"space-y-10",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:"Product Name"}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:t=>r({...s,name:t.target.value}),className:"w-full px-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-semibold outline-none text-sm text-gray-900 transition-all",placeholder:"e.g. Vintage Denim Jacket"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:"Category"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{required:!0,value:s.category,onChange:t=>r({...s,category:t.target.value}),className:"w-full px-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-semibold outline-none text-sm text-gray-900 transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"Select Category"}),T.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("i",{className:"ri-arrow-down-s-line absolute right-6 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:"Product Description"}),e.jsx("textarea",{value:s.description,onChange:t=>r({...s,description:t.target.value}),rows:4,className:"w-full px-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-semibold outline-none text-sm text-gray-900 transition-all resize-none",placeholder:"Provide detailed information about the product..."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:"Pricing Terms"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>r({...s,priceType:"fixed"}),className:`p-6 rounded-[2rem] border-2 text-left transition-all ${s.priceType==="fixed"?"bg-blue-600 border-blue-600 text-white shadow-lg shadow-blue-500/20":"bg-gray-50 border-gray-100 text-gray-900"}`,children:[e.jsx("i",{className:`ri-price-tag-3-line text-2xl mb-4 block ${s.priceType==="fixed"?"text-blue-200":"text-blue-600"}`}),e.jsx("p",{className:"font-bold text-sm uppercase tracking-widest leading-none mb-1",children:"Fixed Price"}),e.jsx("p",{className:`text-[10px] font-semibold ${s.priceType==="fixed"?"text-blue-100":"text-gray-400"}`,children:"Standard selling price"})]}),e.jsxs("button",{type:"button",onClick:()=>r({...s,priceType:"contact"}),className:`p-6 rounded-[2rem] border-2 text-left transition-all ${s.priceType==="contact"?"bg-blue-600 border-blue-600 text-white shadow-lg shadow-blue-500/20":"bg-gray-50 border-gray-100 text-gray-900"}`,children:[e.jsx("i",{className:`ri-customer-service-2-line text-2xl mb-4 block ${s.priceType==="contact"?"text-blue-200":"text-blue-600"}`}),e.jsx("p",{className:"font-bold text-sm uppercase tracking-widest leading-none mb-1",children:"Negotiable"}),e.jsx("p",{className:`text-[10px] font-semibold ${s.priceType==="contact"?"text-blue-100":"text-gray-400"}`,children:"Price discussed via chat"})]})]}),s.priceType==="fixed"&&e.jsx("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:e.jsxs("div",{className:"relative max-w-xs",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 font-bold text-xl text-gray-400",children:"GHâ‚µ"}),e.jsx("input",{type:"number",step:"0.01",required:s.priceType==="fixed",value:s.price,onChange:t=>r({...s,price:t.target.value}),className:"w-full pl-14 pr-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-bold outline-none text-2xl text-gray-900 transition-all",placeholder:"0.00"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:"WhatsApp Contact (Optional)"}),e.jsx("input",{type:"tel",value:s.whatsapp_number,onChange:t=>r({...s,whatsapp_number:t.target.value}),className:"w-full px-6 py-4 bg-gray-50 border-none rounded-2xl focus:ring-2 focus:ring-blue-600/20 font-semibold outline-none text-sm text-gray-900 transition-all",placeholder:"+233 XX XXX XXXX"}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:"Customers can contact you directly on WhatsApp"})]}),e.jsx("div",{className:"flex pt-6",children:e.jsx("button",{type:"submit",disabled:m,className:"flex-1 py-5 bg-gray-900 text-white font-bold text-xs uppercase tracking-widest rounded-2xl hover:bg-black shadow-xl shadow-gray-900/10 transition-all disabled:opacity-50 flex items-center justify-center gap-3 active:scale-[0.98]",children:m?e.jsx("i",{className:"ri-loader-4-line animate-spin text-xl"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Save Changes"}),e.jsx("i",{className:"ri-save-3-fill text-lg"})]})})})]})]})}),e.jsxs("div",{className:"lg:col-span-4 space-y-8",children:[e.jsxs("div",{className:"bg-gray-900 text-white p-8 rounded-[2.5rem] shadow-xl",children:[e.jsxs("h3",{className:"text-xl font-bold mb-8 tracking-tight flex items-center gap-3",children:[e.jsx("i",{className:"ri-image-edit-line text-blue-400"}),"Manage Media"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.images.map((t,a)=>e.jsxs("div",{className:"relative group aspect-square rounded-2xl overflow-hidden bg-gray-800 border border-white/5",children:[e.jsx("img",{src:t,alt:`Product image ${a+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",loading:"lazy"}),e.jsx("button",{type:"button",onClick:()=>N(a),className:"absolute top-2 right-2 w-7 h-7 bg-rose-600 text-white rounded-full flex items-center justify-center shadow-lg opacity-0 group-hover:opacity-100 transition-all hover:bg-rose-700 active:scale-90",children:e.jsx("i",{className:"ri-close-line"})}),a===0&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-blue-600/90 text-white text-[8px] font-bold uppercase tracking-widest text-center py-1.5",children:"Main Cover"})]},a)),s.images.length<8&&e.jsx("div",{className:"aspect-square",children:e.jsx(C,{onImageUploaded:j,folder:"products",shape:"square",size:"medium",className:"w-full h-full bg-gray-800 hover:bg-gray-700 transition-colors rounded-2xl border-2 border-dashed border-gray-700 flex items-center justify-center cursor-pointer group"})})]}),e.jsxs("div",{className:"mt-8 p-6 bg-white/5 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-[10px] font-bold text-blue-400 uppercase tracking-widest mb-2",children:"Product Reference"}),e.jsxs("p",{className:"text-[10px] font-semibold text-gray-500 leading-relaxed break-all",children:["ID: ",l]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-8 rounded-[2rem] border border-blue-100/50",children:[e.jsx("i",{className:"ri-shield-check-fill text-3xl text-blue-600 mb-4 block"}),e.jsx("p",{className:"text-sm font-bold text-blue-950 uppercase tracking-widest mb-2",children:"Security Note"}),e.jsx("p",{className:"text-xs font-semibold text-blue-800/80 leading-relaxed",children:"Updated information is synchronized instantly across the PU Connect marketplace ecosystem."})]})]})]})]})}export{q as default};
//# sourceMappingURL=EditProduct-DsdTEW4s.js.map
