{"version":3,"file":"useSiteContent-DMVoOqg3.js","sources":["../../src/hooks/useSiteContent.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { supabase } from '../lib/supabase';\r\n\r\nexport const CONTENT_KEYS = {\r\n    HOME_HERO_MAIN: 'home_hero_main',\r\n    HOME_HERO_AERIAL: 'home_hero_aerial',\r\n    MARKETPLACE_BANNER: 'marketplace_banner',\r\n    NEWS_BANNER: 'news_banner',\r\n};\r\n\r\nconst DEFAULTS = {\r\n    [CONTENT_KEYS.HOME_HERO_MAIN]: '/Pentecost-University-Sowutoum-Ghana-SchoolFinder-TortoisePathcom-2-1536x1152.jpeg',\r\n    [CONTENT_KEYS.HOME_HERO_AERIAL]: '/Pentecost-University-Sowutoum-Ghana-SchoolFinder-TortoisePathcom-11.jpeg',\r\n    [CONTENT_KEYS.MARKETPLACE_BANNER]: '/Pentecost-University-Sowutoum-Ghana-SchoolFinder-TortoisePathcom-11.jpeg',\r\n    [CONTENT_KEYS.NEWS_BANNER]: '/Pentecost-University-Sowutoum-Ghana-SchoolFinder-TortoisePathcom-2-1536x1152.jpeg',\r\n};\r\n\r\nexport function useSiteContent(key: string) {\r\n    const [url, setUrl] = useState<string>(DEFAULTS[key] || '');\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        let mounted = true;\r\n\r\n        async function checkContent() {\r\n            try {\r\n                // Try to get from localStorage first for speed\r\n                const local = localStorage.getItem(`site_content_${key}`);\r\n                if (local && mounted) {\r\n                    setUrl(local);\r\n                    setLoading(false);\r\n                }\r\n\r\n                // Then fetch fresh config from server\r\n                const { data, error } = await supabase.storage\r\n                    .from('uploads')\r\n                    .download('site_config.json');\r\n\r\n                if (error) throw error;\r\n\r\n                if (data && mounted) {\r\n                    const text = await data.text();\r\n                    const config = JSON.parse(text);\r\n                    const remoteUrl = config[key];\r\n\r\n                    if (remoteUrl) {\r\n                        setUrl(remoteUrl);\r\n                        // Update local cache\r\n                        localStorage.setItem(`site_content_${key}`, remoteUrl);\r\n                    }\r\n                }\r\n            } catch (err) {\r\n                // Silent fail, keep default or local\r\n            } finally {\r\n                if (mounted) setLoading(false);\r\n            }\r\n        }\r\n\r\n        checkContent();\r\n        return () => { mounted = false; };\r\n    }, [key]);\r\n\r\n    return { url, loading };\r\n}\r\n"],"names":["CONTENT_KEYS","DEFAULTS","useSiteContent","key","url","setUrl","useState","loading","setLoading","useEffect","mounted","checkContent","local","data","error","supabase","text","remoteUrl"],"mappings":"kFAGO,MAAMA,EAAe,CACxB,eAAgB,iBAChB,iBAAkB,mBAClB,mBAAoB,qBACpB,YAAa,aACjB,EAEMC,EAAW,CACb,CAACD,EAAa,cAAc,EAAG,qFAC/B,CAACA,EAAa,gBAAgB,EAAG,4EACjC,CAACA,EAAa,kBAAkB,EAAG,4EACnC,CAACA,EAAa,WAAW,EAAG,oFAChC,EAEO,SAASE,EAAeC,EAAa,CACxC,KAAM,CAACC,EAAKC,CAAM,EAAIC,EAAAA,SAAiBL,EAASE,CAAG,GAAK,EAAE,EACpD,CAACI,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EAE3CG,OAAAA,EAAAA,UAAU,IAAM,CACZ,IAAIC,EAAU,GAEd,eAAeC,GAAe,CAC1B,GAAI,CAEA,MAAMC,EAAQ,aAAa,QAAQ,gBAAgBT,CAAG,EAAE,EACpDS,GAASF,IACTL,EAAOO,CAAK,EACZJ,EAAW,EAAK,GAIpB,KAAM,CAAE,KAAAK,EAAM,MAAAC,CAAA,EAAU,MAAMC,EAAS,QAClC,KAAK,SAAS,EACd,SAAS,kBAAkB,EAEhC,GAAID,EAAO,MAAMA,EAEjB,GAAID,GAAQH,EAAS,CACjB,MAAMM,EAAO,MAAMH,EAAK,KAAA,EAElBI,EADS,KAAK,MAAMD,CAAI,EACLb,CAAG,EAExBc,IACAZ,EAAOY,CAAS,EAEhB,aAAa,QAAQ,gBAAgBd,CAAG,GAAIc,CAAS,EAE7D,CACJ,MAAc,CAEd,QAAA,CACQP,KAAoB,EAAK,CACjC,CACJ,CAEA,OAAAC,EAAA,EACO,IAAM,CAAED,EAAU,EAAO,CACpC,EAAG,CAACP,CAAG,CAAC,EAED,CAAE,IAAAC,EAAK,QAAAG,CAAA,CAClB"}